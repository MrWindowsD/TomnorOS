![](https://github.com/MrWindowsD/TomnorOS/blob/main/image/header.gif)

# FixTB and Microcod

Это достаточно большая тема, я не могу тут раскрывать подробности, тем не менее рассмотри основные аcпекты:

1. **Микрокод процессора** — грубо говоря, набор инструкций процессора. Грубо, потому что по сути это не совсем код, а "блоки"
2. **Микрокод BIOS** — тот кто занимается прошивкой BIOS знает что это, он подгружается из прошивки для конкретного процессора, который поддерживает материнская плата. Пока что остановимся тут:

Сразу попробуем определить что за микрокод такой? Это "**CPUID**":

![aida64_zAIHmtWO6Y](https://github.com/user-attachments/assets/ecf66508-5550-40f6-a077-cf8cad75e578)

Если говорить более развёрнуто, то вы утоните в куче технической литературы и терминов. Оно нам не нужно, будем смотреть на всё нагляднее. Так вот, там есть множество полезных вещей, без этого микрокода у процессора ничего работать не будет, и не только у него. Мы можем вскрыть прошивку BIOS, и там посмотреть на EFI драйвера и микрокод при помощи [UBU](https://forums.overclockers.ru/viewtopic.php?f=1&t=479847&start=13460): 

![image](https://github.com/user-attachments/assets/ec9477d0-2564-4625-97b4-97c0087a22ff)

Тут мы можем обновить или проверить наши EFI драйверы. Также посмотреть информацию по микрокоду CPU: 

![image](https://github.com/user-attachments/assets/0addb05f-1963-4783-bcb2-391ae4e8fc89)

Тут мы его можем обновить для нашей прошивки BIOS. Как мы можем видеть тут будет столько CPUID, сколько есть разных CPU для нашей материнской платы. После чего создаётся новый файл bios, для дальнейшей прошивки.
По сути этими инструментами и не только можно отключать/включать или обходить разные ограничения CPU. 

> [!TIP]
> Если кому нужны файлы, то их можно будет найти у меня [тут](https://github.com/MrWindowsD/TomnorOS/releases/tag/UBU). Тут также есть .bat для обновления ПО и установки нужных компонентов для работы.

3. **Микрокод (патч) Windows** — это самая главная тема данного мануала. Microsoft любит устанавливать патчи в на уровне ОС для микрокода процессора. И как правило например Spectre & Meltdown это обычно снижает производительность.
Таких патчей может всякая разное кол-во, в зависимости от версии ОС и поколения CPU они могут различаться и выполнять разные функции. Сегодня мы поговорим про патч _mcupdate_Genuinelntel.dll_, который [замедляет](https://habr.com/ru/news/564180/) работу процессора, и часто негативно работает на технологию **Turbo Boost**. Сами Microsoft это называют драйвером, но это не так. Это инструкции для процессора.
Он буквально ломает TB на некоторых процессорах, к слову, можно установить свой микрокод. Но об этом мы не будем говорить, полезные ссылки приведу позже.

> [!TIP]
> Инструменты для установки своего [микрокода](https://github.com/MrWindowsD/TomnorOS/blob/main/Tools_microcod.rar) (**MWare driver**)

## Удаление патча
С этим патчем некоторые процессоры начинаю занижать свою частоту при нагрузках и в обычных задачах. Я написал не сложный .bat файл, который будет регулярно проверять установку патча и удалять его из ОС. Но хочу заметить, что для этого нужны "уникальные" права администратора.
Это можно и сделать вручную:
1. Патч можно найти: ``` C:\Windows\System32\mcupdate_Genuineintel.dll ```
2. Открываем CMD от админа
3. Пишем команду:
```cmd
takeown /F "C:\Windows\system32\mcupdate_Genuineintel.dll"
```
4. После чего пробуем удалить вручную. Либо используем стороннее ПО
5. Делаем перезагрузку
6. Для того чтобы вернуть патч и восстановить работу, в CMD вводим команду:

 ```cmd
sfc/scannow
```

**Чтобы установить .bat и автоматизировать процесс:**
1. Устанавливаем [FixTB](https://github.com/MrWindowsD/TomnorOS/blob/b1e676f2214c8ce67036589b794c3ee158738128/FixTB%20ver%201.0-beta.rar)
2. Распоковываем архив
3. Запускаем .bat: ```FixTB```
4. делаем перезагрузку
5. Для отката можно использовать .bat: ```delet Fix TB```

> [!TIP]
> Если вы решили удалить патч, нужно обязательно проверить работу CPU в нагрузке, для этого можно воспользоваться [пакетом](https://github.com/MrWindowsD/TomnorOS/releases/tag/Soft) ПО

![](https://github.com/MrWindowsD/TomnorOS/blob/main/image/hr_00000.png)

# Ползные материалы
1. [MCExtractor](https://github.com/platomav/MCExtractor)
2. [EFI Driver](https://winraid.level1techs.com/t/tool-guide-news-uefi-bios-updater-ubu/30357)
3. [Intel/AMD CPU Microcode conversion and utilization without modding the BIOS](https://winraid.level1techs.com/t/guide-intel-amd-cpu-microcode-conversion-and-utilization-without-modding-the-bios/31865)
